apps:
  - name:   "anno-test"
    script: "anno-common/anno-server/server.js"
    watch:  ['anno-common/*/*.js', 'anno-common/*/*.js']
    ignore_watch:
      - 'node_modules'
      - '**/node_modules'
    autorestart: true
    no_daemon: true
    restart_delay: 1000
    env:
      ANNO_LOGLEVEL: silly
      ANNO_ENABLE_JWT_AUTH: true

      ANNO_STORE_HOOKS_PRE: >
        @kba/anno-plugins:PreUserFile
        @kba/anno-plugins:CreatorInjectorFile
        @kba/anno-plugins:PreAclFile

      ANNO_STORE_HOOKS_POST: >
        @kba/anno-plugins:CreatorInjectorFile

      ANNO_USER_FILE: "./users.yaml"
      ANNO_COLLECTION_FILE: "./collections.yaml"

      # ANNO_ACL_FILE: "./anno-common/anno-plugins/acl.anarchy.yaml"
      # ANNO_ACL_FILE: "./anno-common/anno-plugins/acl.use_defaults.yaml"
      ANNO_ACL_FILE: "./acl.yaml"

      ANNO_STORE: '@kba/anno-store-file'
      ANNO_PORT: 33321
      ANNO_OPENAPI_HOST: "localhost:33321"
      ANNO_OPENAPI_BASEPATH: "/anno"
      ANNO_BASE_URL: 'http://localhost:33321'
      ANNO_BASE_PATH: '/anno'
      ANNO_SMTP_HOST: 'localhost'
      ANNO_SMTP_PORT: 25
      ANNO_SMTP_TO: 'registration@localhost'
      ANNO_SMTP_FROM: 'anno@localhost'
